<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SannoMed — Gerador SOAP & Receita (v35)</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
:root{--brand:#0ea5e9;--ink:#0f172a}
body{background:#f8fafc;color:var(--ink)}
.card{background:#fff;border-radius:18px;box-shadow:0 12px 30px rgba(2,6,23,.06)}
.label{font-size:12px;color:#334155;font-weight:600;letter-spacing:.02em}
.input{width:100%;padding:.7rem .9rem;border:1px solid #e2e8f0;border-radius:12px;outline:none}
.btn{padding:.55rem .9rem;border-radius:10px;font-weight:700}
.btn-primary{background:var(--brand);color:#fff}
.btn-ghost{border:1px solid #e2e8f0;background:#fff}
.btn-sm{padding:.3rem .5rem;font-size:11px;border-radius:8px;font-weight:600}
.btn-xs{padding:.2rem .4rem;font-size:10px;border-radius:8px;font-weight:600}
.mono{white-space:pre-wrap;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Courier New",monospace;font-size:13px;line-height:1.5}
.rx-card{border:1px solid #e2e8f0;border-radius:10px;padding:10px;display:flex;flex-direction:column;min-height:185mm}
.rx-headline{font-size:14px;font-weight:800;text-align:center;margin-bottom:4px}
.rx-header{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:3px;margin-bottom:4px}
.rx-header img{height:36px}
.rx-brand{font-weight:800;letter-spacing:.02em}
.rx-meta{font-size:11px;color:#334155;text-align:center}
.rx-body{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Courier New",monospace;font-size:11px;line-height:1.5;white-space:pre-wrap;flex:1 1 auto}
.sig{border-top:1px solid #000;width:100%;text-align:center;font-size:11px;padding-top:4px;margin-top:8px}
.editable{min-height:220px;border:1px solid #e2e8f0;border-radius:12px;padding:.75rem .9rem;outline:none}
.editable:empty:before{content:attr(data-placeholder);color:#94a3b8}
.chip{display:inline-flex;align-items:center;gap:6px;padding:.3rem .5rem;border:1px solid #e2e8f0;border-radius:999px;font-size:11px}
.brand-bar{display:flex;align-items:center;gap:10px;justify-content:center;text-align:center}
.brand-bar .clinic{font-weight:800;font-size:14px;letter-spacing:.02em}
.brand-bar .meta{font-size:11px;color:#334155}
.divider{height:2px;background:linear-gradient(90deg,transparent,var(--brand),transparent);margin:6px 0}
@media print{@page{size:A4 landscape;margin:12mm}.no-print{display:none!important}.print-only{display:block!important}body{background:#fff}.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:10px}.brand-print{margin-bottom:6px}}
.print-only{display:none}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.break-after{page-break-after:always}
</style>
</head>
<body>
<main class="max-w-6xl mx-auto p-6">
<header class="no-print mb-6">
  <div class="brand-bar">
    <img src="./logo.png" class="h-10 w-auto rounded-sm ring-1 ring-slate-200 bg-white p-1" alt="SannoMed">
    <div>
      <div class="clinic">SannoMed</div>
      <div class="meta">Rua Otto Júlio Malina, 671 • Tel: (48) 3034-3735 • contato@sannomed.com.br</div>
    </div>
  </div>
  <div class="divider"></div>
  <div class="flex items-center justify-between">
    <h1 class="text-xl font-bold">Gerador SOAP & Receita — Emagrecimento</h1>
    <div class="hidden md:flex gap-2 text-sm text-slate-600"><span><strong>IMC:</strong> <span id="imcVal">—</span></span></div>
  </div>
</header>

<section class="grid grid-cols-1 lg:grid-cols-2 gap-6 no-print">
  <form id="formPront" class="card p-6 space-y-5">
    <h2 class="text-lg font-semibold">Prontuário — Via única</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
      <label class="label">#Data automática<input type="date" name="dataConsulta" id="dataConsulta" class="input"></label>
      <label class="label">#Nome do paciente<input name="nome" class="input" value="LAILA JANAINA"></label>
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
      <label class="label">Peso (kg)<input type="number" step="0.1" name="peso" id="peso" class="input" value="65"></label>
      <label class="label">Altura (m)<input type="number" step="0.01" name="altura" id="altura" class="input" value="1.69"></label>
      <div class="label">IMC<div class="input bg-slate-50"><span id="imcBadge">—</span></div></div>
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
      <label class="label">#Comorbidade<input name="comorbidade" class="input" value="Nega"></label>
      <label class="label">#Alergias<input name="alergias" class="input" value="Nega"></label>
      <label class="label">#MUC<input name="muc" class="input" value="Nega"></label>
    </div>
    <label class="label">#S:<textarea name="S" rows="4" class="input"></textarea></label>
    <label class="label">#O:<textarea name="O" rows="5" class="input">BEG, LOC, AAA
AC: RCR 2T BNF SS | AP: MV+ bilat., sem ruídos adventícios
Abdome: RHA+, depressível, sem dor
Neuro: sem déficits focais</textarea></label>
    <label class="label">#P:<textarea name="P" rows="7" class="input">Prescrevo.
Oriento prática regular de atividade física. Evitar jejum prolongado e bebidas
açucaradas e aumentar ingesta hídrica.
Explico sobre fisiologia dos medicamentos, explico sobre possíveis efeitos
colaterais associados.
Alerto sobre sinais de alarme: dor abdominal intensa, náuseas persistentes,
vômitos, icterícia, palpitações, hipotensão, hipoglicemia — se presentes,
buscar avaliação médica.</textarea></label>
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-3 pt-1">
      <button type="button" id="btnPrint" class="btn btn-primary w-full">Baixar/Imprimir (2 páginas)</button>
      <button type="button" id="btnCopiarTexto" class="btn btn-ghost w-full">Copiar SOAP</button>
      <div class="flex gap-2"><button type="button" id="btnCompactar" class="btn-xs btn-ghost">Compactar</button><button type="button" id="btnExpandir" class="btn-xs btn-ghost">Expandir</button></div>
    </div>
  </form>

  <div class="card p-6 space-y-4">
    <h3 class="text-lg font-semibold mb-2">Prescrição (prévia) — <span class="text-slate-500">editável</span></h3>
    <div id="previewRX" class="mono editable" contenteditable="true" data-placeholder="Monte pelos seletores abaixo ou digite/cole aqui. O que estiver aqui será impresso."></div>
    <p class="text-xs text-slate-500 mt-2">Dica: Enter ×2 cria uma linha em branco; as quebras são preservadas.</p>
  </div>
</section>

<section class="mt-8 card p-6 space-y-5 no-print">
  <h2 class="text-lg font-semibold">Selecionar medicações</h2>
  <div class="grid grid-cols-1 md:grid-cols-7 gap-3">
    <div class="label">Principal</div>
    <label class="chip"><input type="radio" name="principal" value="wegovy" checked> Wegovy</label>
    <label class="chip"><input type="radio" name="principal" value="mounjaro"> Mounjaro</label>
    <label class="label md:col-span-2">Apresentação
      <select id="apres" class="input">
        <optgroup label="Wegovy — canetas">
          <option value="wg-0.25">Wegovy 0,25 mg (pen)</option>
          <option value="wg-0.5">Wegovy 0,5 mg (pen)</option>
          <option value="wg-1.0">Wegovy 1 mg (pen)</option>
          <option value="wg-1.7">Wegovy 1,7 mg (pen)</option>
          <option value="wg-2.4">Wegovy 2,4 mg (pen)</option>
        </optgroup>
        <optgroup label="Mounjaro — seringas pré-cheias">
          <option value="mj-2.5">Mounjaro 2,5 mg/dose</option>
          <option value="mj-5">Mounjaro 5 mg/dose</option>
          <option value="mj-7.5">Mounjaro 7,5 mg/dose</option>
          <option value="mj-10">Mounjaro 10 mg/dose</option>
        </optgroup>
      </select>
    </label>
    <label class="label">Dose semanal (Wegovy, mg)<input id="wgDose" type="number" step="0.25" min="0.25" value="0.25" class="input"></label>
    <label class="label">Multiplicadores Wegovy<input id="wgMult" class="input" value="1,1,2,2,4"></label>
    <label class="label">Nº de doses (Mounjaro)<input type="number" min="1" step="1" id="nDoses" value="4" class="input"></label>
  </div>
  <div class="flex flex-wrap gap-3">
    <button type="button" id="btnPreviewPrincipal" class="btn btn-ghost">Pré-visualizar principal</button>
    <button type="button" id="btnAddPrincipal" class="btn btn-primary">Adicionar principal</button>
  </div>
  <hr/>
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
    <div class="flex items-center gap-2">
      <input type="checkbox" id="selOnd"><label for="selOnd" class="label">Ondansetrona 8 mg</label>
      <button type="button" id="btnAddOnd" class="btn-sm btn-ghost">Adicionar</button>
    </div>
    <div class="flex items-center gap-2">
      <input type="checkbox" id="selPeg"><label for="selPeg" class="label">PEG-Lax (polietilenoglicol) 17 g</label>
      <button type="button" id="btnAddPeg" class="btn-sm btn-ghost">Adicionar</button>
    </div>
    <div class="flex items-center gap-2">
      <input id="customTxt" class="input" placeholder="Outro item...">
      <button type="button" id="btnAddCustom" class="btn-sm btn-ghost">Adicionar</button>
    </div>
    <div class="flex items-center gap-2">
      <input type="checkbox" id="selSimcaps"><label for="selSimcaps" class="label">Simcaps (Vitafor) — probióticos 3BI</label>
      <button type="button" id="btnAddSimcaps" class="btn-sm btn-ghost">Adicionar</button>
    </div>
    <div class="flex items-center gap-2">
      <input type="checkbox" id="selOmega"><label for="selOmega" class="label">Ômega 3 — Omegafor/Essential/Equaliv</label>
      <button type="button" id="btnAddOmega" class="btn-sm btn-ghost">Adicionar</button>
    </div>
    <div class="flex items-center gap-2">
      <input type="checkbox" id="selCreatina"><label for="selCreatina" class="label">Creatina — Nutrata/Integral/Adaptogen/ON/Equaliv</label>
      <button type="button" id="btnAddCreatina" class="btn-sm btn-ghost">Adicionar</button>
    </div>
  </div>
  <div class="mt-2 flex gap-2"><button type="button" id="btnLimparTodos" class="btn btn-ghost">Limpar prescrição</button></div>
</section>

<section id="printSOAP" class="print-only break-after">
  <div class="brand-print brand-bar">
    <img src="./logo.png" class="h-10 w-auto" alt="SannoMed">
    <div><div class="clinic">SannoMed</div><div class="meta">Rua Otto Júlio Malina, 671 • Tel: (48) 3034-3735 • contato@sannomed.com.br</div></div>
  </div>
  <pre id="outSOAP" class="mono"></pre>
</section>

<section id="printRX" class="print-only">
  <div class="grid-2">
    <div id="rxVia1" class="rx-card">
      <div class="rx-headline">Receita médica — 1ª via</div>
      <div class="rx-header"><img src="./logo.png" alt="SannoMed"><div class="rx-brand">SannoMed</div><div class="rx-meta">Rua Otto Júlio Malina, 671 • Tel: (48) 3034-3735 • contato@sannomed.com.br</div></div>
      <div class="rx-meta" id="meta1"></div>
      <div class="rx-body" id="body1"></div>
      <div class="sig">Dra. Laila Janaína dos Santos — CRM-SC 38237</div>
    </div>
    <div id="rxVia2" class="rx-card">
      <div class="rx-headline">Receita médica — 2ª via</div>
      <div class="rx-header"><img src="./logo.png" alt="SannoMed"><div class="rx-brand">SannoMed</div><div class="rx-meta">Rua Otto Júlio Malina, 671 • Tel: (48) 3034-3735 • contato@sannomed.com.br</div></div>
      <div class="rx-meta" id="meta2"></div>
      <div class="rx-body" id="body2"></div>
      <div class="sig">Dra. Laila Janaína dos Santos — CRM-SC 38237</div>
    </div>
  </div>
</section>
</main>
<script>
// Data automática
(function(){var el=document.getElementById('dataConsulta');var t=new Date();var iso=new Date(t.getTime()-t.getTimezoneOffset()*60000).toISOString().slice(0,10);if(el)el.value=iso;})();
// IMC
(function(){var p=document.getElementById('peso'),a=document.getElementById('altura');function up(){var pv=parseFloat(p&&p.value),av=parseFloat(a&&a.value);var imc=(pv>0&&av>0)?(pv/(av*av)):NaN;var txt=isFinite(imc)?imc.toFixed(1):'—';var v1=document.getElementById('imcVal');if(v1)v1.textContent=txt;var v2=document.getElementById('imcBadge');if(v2)v2.textContent=txt;}if(p)p.addEventListener('input',up);if(a)a.addEventListener('input',up);up();})();
// SOAP
function buildSOAP(d){var imcText=(d.peso&&d.altura)?( (parseFloat(d.peso)/(Math.pow(parseFloat(d.altura),2))).toFixed(1) ):'';return "#Data: "+(d.dataConsulta||'')+"
#Nome do paciente: "+(d.nome||'')+"
#Comorbidade: "+(d.comorbidade||'NEGA')+"
#Alergias: "+(d.alergias||'NEGA')+"
#MUC: "+(d.muc||'')+"
#Peso: "+(d.peso||'')+" | #Altura: "+(d.altura||'')+" | #IMC: "+imcText+"
#S:
"+(d.S||'')+"
#O:
"+(d.O||'')+"
#P:
"+(d.P||'');}
var previewDiv=document.getElementById('previewRX');
function getPreviewAsPlain(){var html=(previewDiv&&previewDiv.innerHTML)||'';html=html.replace(/
/g,'
').replace(/&nbsp;/g,' ').replace(/<div><br\s*\/?><\/div>/gi,'

').replace(/<br\s*\/?>(?=\s*<br\s*\/?>(\s|
|)*)/gi,'<br><br>').replace(/<br\s*\/?>(?!
)/gi,'
').replace(/<\/div>\s*<div>/gi,'
').replace(/<div>/gi,'').replace(/<\/div>/gi,'');html=html.replace(/<[^>]+>/g,'');return html.replace(/\s+$/,'');}
function encodeHTML(s){return (s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}
var ORD=["primeira","segunda","terceira","quarta","quinta","sexta","sétima","oitava","nona","décima"];
var BASE={"wg-0.25":75,"wg-0.5":37,"wg-1.0":19,"wg-1.7":11,"wg-2.4":8};
var LABELS={"wg-0.25":"0,25mg","wg-0.5":"0,5mg","wg-1.0":"1mg","wg-1.7":"1,7mg","wg-2.4":"2,4mg"};
function buildWegovy(apres,dose,mstr){var base=BASE[apres];var label=LABELS[apres];var factor=Math.max(0.25,parseFloat(dose||'0.25'))/0.25;var mult=(mstr||'1,1,2,2,4').split(',').map(s=>parseFloat(s.trim())).filter(n=>!isNaN(n)&&n>0);if(!mult.length)mult=[1,1,2,2,4];var lines=[];for(let i=0;i<mult.length;i++){let ord=ORD[i]||(i+1)+'ª';let clicks=Math.round(base*factor*mult[i]);lines.push("Na "+ord+" semana aplicar "+clicks+" cliques");}
return "1. Wegovy "+label+" (Semaglutida) - 1Cx
Aplicar por via subcutânea, 1x por semana, sempre no mesmo dia. 
"+lines.join("
")+"
Local de aplicação cerca de 4 dedos da cicatriz umbilical, alternando os locais de aplicação";}
function buildMounjaro(label,n){var d=(label||'').replace('Mounjaro ','').replace(' mg/dose','').trim();var dosePretty=d.replace(' ','');var nd=Math.max(1,parseInt(n||'4',10));return "1. Mounjaro "+dosePretty+"mg - 1CX
Aplicar por via subcutânea, 1x por semana, sempre no mesmo dia ("+nd+" doses) 
Local de aplicação cerca de 4 dedos da cicatriz umbilical, alternando os locais de aplicação";}
function byId(id){return document.getElementById(id)};function onClick(id,fn){var el=byId(id);if(el)el.addEventListener('click',fn);}
function computePrincipal(){var med=(document.querySelector('input[name="principal"]:checked')||{}).value||'wegovy';var apres=byId('apres')&&byId('apres').value;var d=byId('wgDose')&&byId('wgDose').value;var m=byId('wgMult')&&byId('wgMult').value;var n=byId('nDoses')&&byId('nDoses').value;if(med==='wegovy'){return buildWegovy(apres,d,m);}else{var sel=byId('apres');var label=sel&&sel.selectedOptions&&sel.selectedOptions[0]?sel.selectedOptions[0].textContent:'Mounjaro 2,5 mg/dose';return buildMounjaro(label,n);}}
onClick('btnPreviewPrincipal',function(){var txt=computePrincipal();var cur=getPreviewAsPlain();if(previewDiv)previewDiv.textContent=txt+(cur?("

"+cur):"");});
onClick('btnAddPrincipal',function(){var txt=computePrincipal();var cur=getPreviewAsPlain();if(previewDiv)previewDiv.textContent=txt+(cur?("

"+cur):"");});
onClick('btnAddOnd',function(){var c=byId('selOnd');if(!c||!c.checked)return;var cur=getPreviewAsPlain();var t="USO ORAL 
1. Ondansetrona (ondif ou similar) 8mg _ Cx 
Tomar 1 cp de 8 em 8h se náusea ou enjoo";if(previewDiv)previewDiv.textContent=cur?(cur+"

"+t):t;});
onClick('btnAddPeg',function(){var c=byId('selPeg');if(!c||!c.checked)return;var cur=getPreviewAsPlain();var t="USO ORAL
2. PEG-Lax (polietilenoglicol) 17 g _ Cx
Diluir 1 sachê (17 g) em um copo de água filtrada e tomar 1x ao dia. 
Aumentar ingesta hídrica e de alimentos ricos em fibra";if(previewDiv)previewDiv.textContent=cur?(cur+"

"+t):t;});
onClick('btnAddSimcaps',function(){var c=byId('selSimcaps');if(!c||!c.checked)return;var cur=getPreviewAsPlain();var t="USO ORAL
3. Simcaps (Vitafor) — mix de probióticos 3BI _ Fr
Tomar 1 cp ao dia.";if(previewDiv)previewDiv.textContent=cur?(cur+"

"+t):t;});
onClick('btnAddOmega',function(){var c=byId('selOmega');if(!c||!c.checked)return;var cur=getPreviewAsPlain();var t="USO ORAL
4. Ômega 3 (Omegafor - Vitafor / Essential / Equaliv) _ Fr
Tomar 1 cp ao dia.";if(previewDiv)previewDiv.textContent=cur?(cur+"

"+t):t;});
onClick('btnAddCreatina',function(){var c=byId('selCreatina');if(!c||!c.checked)return;var cur=getPreviewAsPlain();var t="USO ORAL
5. Creatina (Nutrata / Integral Médica / Adaptogen / ON / Equaliv) _ Pó
Tomar 3 g (1 scoop) ao dia, diluída em água ou outra bebida de preferência.";if(previewDiv)previewDiv.textContent=cur?(cur+"

"+t):t;});
onClick('btnAddCustom',function(){var tEl=byId('customTxt');var t=(tEl&&tEl.value||'').trim();if(!t)return;var cur=getPreviewAsPlain();if(previewDiv)previewDiv.textContent=cur?(cur+"

"+t):t;if(tEl)tEl.value='';});
onClick('btnLimparTodos',function(){if(previewDiv)previewDiv.textContent='';});
onClick('btnCompactar',function(){document.querySelectorAll('.rx-body, #previewRX').forEach(el=>el.style.fontSize='10px');});
onClick('btnExpandir',function(){document.querySelectorAll('.rx-body, #previewRX').forEach(el=>el.style.fontSize='12px');});
onClick('btnCopiarTexto',function(){var form=document.getElementById('formPront');if(!form)return;var fd=new FormData(form),data={};fd.forEach((v,k)=>data[k]=v);var soap=buildSOAP(data);if(navigator.clipboard&&navigator.clipboard.writeText){navigator.clipboard.writeText(soap).catch(()=>{});} });
function formatDateBR(iso){if(!iso)return'';var p=iso.split('-');return p.length===3?(p[2]+'/'+p[1]+'/'+p[0]):iso;}
function renderViaHTML(prefix,nome,data,plain){var meta=byId('meta'+prefix),body=byId('body'+prefix);if(!meta||!body)return;meta.textContent="Paciente: "+(nome||'')+" • Data: "+(formatDateBR(data)||'');var safe=(plain||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');body.innerHTML=safe.replace(/
/g,'<br>');}
function prepareAndPrint(){var form=document.getElementById('formPront');if(!form)return;var fd=new FormData(form),data={};fd.forEach((v,k)=>data[k]=v);var soap=buildSOAP(data);var out=document.getElementById('outSOAP');if(out)out.textContent=soap;var block=getPreviewAsPlain();renderViaHTML('1',data.nome,data.dataConsulta,block||'—');renderViaHTML('2',data.nome,data.dataConsulta,block||'—');requestAnimationFrame(()=>requestAnimationFrame(()=>window.print()));}
onClick('btnPrint',prepareAndPrint);
</script>
</body>
</html>
